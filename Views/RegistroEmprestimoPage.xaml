<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BibliotecaAPP.Views.RegistroEmprestimoPage"
             Title="Registro de Empréstimo"
             BackgroundColor="Transparent"
             NavigationPage.HasNavigationBar="False">

	<Grid>
		<!-- Background image with dak overlay -->
		<Image Source="login_biblioteca.jpg" Aspect="AspectFill" Opacity="1.0" IsOpaque="True" />
		<BoxView BackgroundColor="#0B1D49" Opacity="0.75" InputTransparent="True" />

		<ScrollView>
			<VerticalStackLayout Padding="30" Spacing="25"
                                VerticalOptions="Center" HorizontalOptions="Center">

				<!-- Title -->
				<Label Text="Registro de Empréstimo"
                       FontSize="28"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalOptions="Center"
                       Margin="0,0,0,10" />

				<!-- Member Selection -->
                <!-- Member Selection -->
                <Border BackgroundColor="#1E2A5E" StrokeThickness="0" Padding="15">
                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Label Text="Membro:" TextColor="#F97316" FontSize="16" FontAttributes="Bold" VerticalOptions="Center" WidthRequest="80"/>
                        <Picker x:Name="ComboBoxMembros"
                Title="Selecionar Membro"
                BackgroundColor="White"
                TextColor="#333"
                FontSize="14"
                HeightRequest="60"
                WidthRequest="300"
                HorizontalOptions="FillAndExpand" />
                    </HorizontalStackLayout>
                </Border>

                <!-- Book and Duration -->
                <Border BackgroundColor="#1E2A5E" StrokeThickness="0" Padding="15">
                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Label Text="Livro:" TextColor="#F97316" FontSize="16" FontAttributes="Bold" VerticalOptions="Center" WidthRequest="80"/>
                        <Picker x:Name="ComboBoxLivros"
                Title="Selecionar Livro"
                BackgroundColor="White"
                TextColor="#333"
                FontSize="14"
                HeightRequest="70"
                WidthRequest="300"                
                HorizontalOptions="FillAndExpand" />

                        <Entry x:Name="TextBoxDuracao"
               Placeholder="Dias"
               Keyboard="Numeric"
               BackgroundColor="White"
               TextColor="#333"
               FontSize="14"
               HeightRequest="70"
               WidthRequest="20"
               HorizontalTextAlignment="Center"
               Margin="0" />
                    </HorizontalStackLayout>
                </Border>


                <!-- Dates -->
                <Border BackgroundColor="#1E2A5E" StrokeThickness="0" Padding="15">
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Datas" TextColor="#F97316" FontSize="16" FontAttributes="Bold" />

                        <Grid ColumnSpacing="10" RowSpacing="5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- Label and DatePicker Empréstimo -->
                            <Label Text="Empréstimo:" TextColor="#F97316" FontSize="14" FontAttributes="Bold" Grid.Column="0" Grid.Row="0" VerticalOptions="Center" />
                            <DatePicker x:Name="DatePickerEmprestimo"
                        Grid.Column="0" Grid.Row="1"
                        BackgroundColor="White"
                        TextColor="#333"
                        FontSize="14"
                        HeightRequest="45"
                        WidthRequest="100"
                        Format="dd/MM/yyyy" />

                            <!-- Label and DatePicker Devolução -->
                            <Label Text="Devolução:" TextColor="#F97316" FontSize="14" FontAttributes="Bold" Grid.Column="1" Grid.Row="0" VerticalOptions="Center" />
                            <DatePicker x:Name="DatePickerDevolucao"
                        Grid.Column="1" Grid.Row="1"
                        BackgroundColor="White"
                        TextColor="#333"
                        FontSize="14"
                        HeightRequest="45"
                        WidthRequest="100"
                        Format="dd/MM/yyyy" />
                        </Grid>
                    </VerticalStackLayout>
                </Border>


                <!-- Add Book Button -->
				<Button Text="Adicionar Livro à Lista"
                        Clicked="AdicionarLivro_Click"
                        BackgroundColor="#F97316"
                        TextColor="White"
                        FontAttributes="Bold"
                        FontSize="16"
                        CornerRadius="8"
                        HeightRequest="50" />

				<!-- Loaned Books List -->
				<Border BackgroundColor="#1E2A5E" StrokeThickness="0" Padding="15">
					<VerticalStackLayout Spacing="10">
						<Label Text="Livros Emprestados"
                               TextColor="#F97316"
                               FontAttributes="Bold"
                               FontSize="16" />

						<Frame BackgroundColor="White"
                               CornerRadius="8"
                               Padding="0"
                               HasShadow="False"
                               HeightRequest="150">
							<CollectionView x:Name="LivrosCollectionView" EmptyView="Nenhum livro adicionado">
								<CollectionView.EmptyViewTemplate>
									<DataTemplate>
										<Label Text="Nenhum livro adicionado"
                                               TextColor="#999"
                                               HorizontalOptions="Center"
                                               VerticalOptions="Center" />
									</DataTemplate>
								</CollectionView.EmptyViewTemplate>
								<CollectionView.ItemTemplate>
									<DataTemplate>
										<Grid Padding="10" ColumnSpacing="10">
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="2*" />
												<ColumnDefinition Width="1*" />
											</Grid.ColumnDefinitions>
											<Label Text="{Binding Livro}" FontAttributes="Bold" TextColor="#333" FontSize="14" />
											<Label Text="{Binding Duracao, StringFormat='{0} dias'}"
                                                   Grid.Column="1"
                                                   HorizontalTextAlignment="End"
                                                   TextColor="#666"
                                                   FontSize="14" />
										</Grid>
									</DataTemplate>
								</CollectionView.ItemTemplate>
							</CollectionView>
						</Frame>
					</VerticalStackLayout>
				</Border>

				<!-- Action Buttons -->
				<Grid ColumnSpacing="15" Margin="0,10,0,0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="1*" />
						<ColumnDefinition Width="1*" />
					</Grid.ColumnDefinitions>

					<Button Grid.Column="0"
                            Text="Confirmar"
                            Clicked="Confirmar_Click"
                            BackgroundColor="#F97316"
                            TextColor="White"
                            FontAttributes="Bold"
                            FontSize="16"
                            CornerRadius="8"
                            HeightRequest="50" />

					<Button Grid.Column="1"
                            Text="Cancelar"
                            Clicked="Cancelar_Click"
                            BackgroundColor="Transparent"
                            TextColor="White"
                            BorderColor="White"
                            BorderWidth="2"
                            FontSize="16"
                            CornerRadius="8"
                            HeightRequest="50" />
				</Grid>

			</VerticalStackLayout>
		</ScrollView>
	</Grid>
</ContentPage>