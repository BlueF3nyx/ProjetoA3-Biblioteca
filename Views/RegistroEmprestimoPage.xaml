<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BibliotecaAPP.Views.RegistroEmprestimoPage"
             Title="Registrar Emprestimo"
             BackgroundColor="Transparent"
             NavigationPage.HasNavigationBar="False">

    <Grid>
        <!-- Imagem de fundo -->
        <Image Source="login_biblioteca.jpg"
               Aspect="AspectFill"
               Opacity="1.0"
               IsOpaque="True" />

        <!-- Camada azul escura translucida -->
        <BoxView BackgroundColor="#0B1D49"
                 Opacity="0.75"
                 InputTransparent="True" />

        <!-- Conteudo principal -->
        <ScrollView>
            <VerticalStackLayout Spacing="20" Padding="30" VerticalOptions="Center">

                <!-- Titulo -->
                <Label Text="Registrar Emprestimo"
                       FontSize="24"
                       TextColor="White"
                       FontAttributes="Bold"
                       HorizontalOptions="Center" />

                <!-- Selecao de Membro -->
                <VerticalStackLayout Spacing="5">
                    <Label Text="Membro:" TextColor="White" FontSize="14" />
                    <Picker x:Name="ComboBoxMembros"
                            Title="Selecione um membro"
                            BackgroundColor="White"
                            TextColor="Black"
                            HeightRequest="40">
                        <!-- Exemplo de itens - substitua por dados reais do banco -->
                        <Picker.Items>
                            <x:String>Joao Silva</x:String>
                            <x:String>Maria Oliveira</x:String>
                            <x:String>Carlos Santos</x:String>
                        </Picker.Items>
                    </Picker>
                </VerticalStackLayout>

                <!-- Grupo: Livro  Duracao -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <!-- Livro -->
                    <VerticalStackLayout Spacing="5" Grid.Column="0">
                        <Label Text="Livro:" TextColor="White" FontSize="14" />
                        <Picker x:Name="ComboBoxLivros"
                                Title="Selecione um livro"
                                BackgroundColor="White"
                                TextColor="Black"
                                HeightRequest="40">
                            <!-- Exemplo de itens - substitua por dados reais do banco -->
                            <Picker.Items>
                                <x:String>Dom Quixote</x:String>
                                <x:String>1984</x:String>
                                <x:String>O Senhor dos Aneis</x:String>
                            </Picker.Items>
                        </Picker>
                    </VerticalStackLayout>

                    <!-- Duracao -->
                    <VerticalStackLayout Spacing="5" Grid.Column="1">
                        <Label Text="Duracao (dias):" TextColor="White" FontSize="14" />
                        <Entry x:Name="TextBoxDuracao"
                               Keyboard="Numeric"
                               BackgroundColor="White"
                               TextColor="Black"
                               Placeholder="Ex: 7"
                               PlaceholderColor="Gray"
                               HeightRequest="40"
                               HorizontalTextAlignment="Center" />
                    </VerticalStackLayout>
                </Grid>

                <!-- Grupo: Datas -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <!-- Data Emprestimo -->
                    <VerticalStackLayout Spacing="5" Grid.Column="0">
                        <Label Text="Data Emprestimo:" TextColor="White" FontSize="14" />
                        <DatePicker x:Name="DatePickerEmprestimo"
                                    BackgroundColor="White"
                                    TextColor="Black"
                                    HeightRequest="40" />
                    </VerticalStackLayout>

                    <!-- Data Devolucao -->
                    <VerticalStackLayout Spacing="5" Grid.Column="1">
                        <Label Text="Data Devolucao:" TextColor="White" FontSize="14" />
                        <DatePicker x:Name="DatePickerDevolucao"
                                    BackgroundColor="White"
                                    TextColor="Black"
                                    HeightRequest="40"
                                    IsEnabled="False" />
                    </VerticalStackLayout>
                </Grid>

                <!-- Botao Adicionar Livro -->
                <Button Text="Adicionar Livro"
                        BackgroundColor="#F97316"
                        TextColor="White"
                        FontAttributes="Bold"
                        CornerRadius="5"
                        HeightRequest="45"
                        Clicked="AdicionarLivro_Click" />

                <!-- Lista de livros -->
                <VerticalStackLayout Spacing="5">
                    <Label Text="Livros Emprestados:" 
                           TextColor="White" 
                           FontSize="14" 
                           FontAttributes="Bold" />

                    <CollectionView x:Name="LivrosCollectionView"
                                   HeightRequest="150"
                                   BackgroundColor="#FFFFFF20">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10" ColumnDefinitions="*,100,120,120">
                                    <Label Text="{Binding Livro}" 
                                           TextColor="White"
                                           Grid.Column="0" />
                                    <Label Text="{Binding Duracao}" 
                                           TextColor="White"
                                           HorizontalTextAlignment="Center"
                                           Grid.Column="1" />
                                    <Label Text="{Binding DataEmprestimo, StringFormat='{0:dd/MM/yyyy}'}" 
                                           TextColor="White"
                                           HorizontalTextAlignment="Center"
                                           Grid.Column="2" />
                                    <Label Text="{Binding DataDevolucao, StringFormat='{0:dd/MM/yyyy}'}" 
                                           TextColor="White"
                                           HorizontalTextAlignment="Center"
                                           Grid.Column="3" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

                <!-- Botoes Confirmar e Cancelar -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="20">
                    <Button Text="Confirmar"
                            BackgroundColor="#4CAF50"
                            TextColor="White"
                            FontAttributes="Bold"
                            CornerRadius="5"
                            HeightRequest="45"
                            Clicked="Confirmar_Click"
                            Grid.Column="0" />

                    <Button Text="Cancelar"
                            BackgroundColor="#F44336"
                            TextColor="White"
                            FontAttributes="Bold"
                            CornerRadius="5"
                            HeightRequest="45"
                            Clicked="Cancelar_Click"
                            Grid.Column="1" />
                </Grid>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>